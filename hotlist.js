var json = {"code":"<!DOCTYPE html>\n<html>\n    <head>\n        <meta charset=\"utf-8\">\n        <title>gravy juice world</title>\n        <style>\n            *{\n                margin:0;\n                overflow:clip;\n            }\n            #myCanvas{\n                image-rendering:pixelated;\n                width:600px;\n                height:600px;\n            }\n        </style>\n    </head>\n    <body>\n        <pre id = \"timer\" style=\"position:absolute;top:0px;left:0px;background-color:white;\">0.00</pre>\n        <canvas id = \"myCanvas\" width = \"200\" height = \"200\"></canvas>\n        <pre id = \"pos\"></pre>\n        <pre id = \"logger\"></pre>\n        <script id = \"vertex-shader\" type = \"glsl\">#version 300 es\n            in vec4 a_pos;\n            in vec4 a_col;\n            in vec2 a_texCoord;\n            \n            uniform mat4 u_matrix;\n            \n            out vec4 v_col;\n            out vec2 v_texCoord;\n            out vec3 v_pos;\n            void main(){\n                gl_Position = u_matrix * a_pos;\n                v_pos = gl_Position.xyz;\n                v_col = a_col;\n                v_texCoord = a_texCoord;\n            }\n        </script>\n        <script id = \"fragment-shader\" type = \"glsl\">#version 300 es\n            precision highp float;\n            in vec4 v_col;\n            in vec3 v_pos;\n            in vec2 v_texCoord;\n            \n            uniform sampler2D bathroom;\n            uniform int u_win;\n            \n            out vec4 o_FragColor;\n            \n            void main(){\n                o_FragColor = vec4((texture(bathroom,v_texCoord).xyz)/(length(v_pos)*0.2),1);\n                if(u_win==1){\n                    o_FragColor = vec4(0,1,1,1);\n                }\n            }\n        </script>\n        <script src=\"https://cdn.jsdelivr.net/npm/gl-matrix@2.8.1/dist/gl-matrix-min.js\"></script>\n        <script src = \"./glmatrix.js\"></script>\n        <script type = \"module\">\n        const log = (function(){\n            const logger = document.getElementById(\"logger\");\n            return (...a) => {\n                logger.innerHTML += a + \"<br>\";\n            };\n        })();\n        try{\n            const clamp = (a,b,c) => {\n                if(a<b){\n                    return b;\n                }else if(a>c){\n                    return c;\n                }\n                return a;\n            };\n            const lerp = (a,b,c) => a+(b-a)*c;\n            \n            const textureCanvas = new OffscreenCanvas(400,400);\n            const t_ctx = textureCanvas.getContext(\"2d\");\n            t_ctx.fillRect(0,0,400,400);\n            t_ctx.fillStyle = \"red\";\n            t_ctx.fillRect(100,100,200,200);\n            \n            const canvas = document.getElementById(\"myCanvas\");\n            const gl = canvas.getContext(\"webgl2\",{preserveDrawingBuffer:true});\n            \n            const mouse = {\n                x:0,\n                y:0,\n                dx:0,\n                dy:0,\n                resetDelta(){\n                    this.dx = this.dy = 0;\n                }\n            };\n            canvas.onmousemove = function(e){\n                mouse.x = e.x;\n                mouse.y = e.y;\n                mouse.dx += e.movementX;\n                mouse.dy += e.movementY;\n            };\n            canvas.onclick = function(){\n                canvas.requestPointerLock();\n            };\n            const keys = {};\n            document.onkeydown = function(e){\n                keys[e.key.toString().toLowerCase()] = true;\n                if(e.key.toString() == \" \") e.preventDefault();\n            };\n            document.onkeyup = function(e){\n                keys[e.key.toString().toLowerCase()] = !true;\n                if(e.key.toString() == \"m\"){\n                    player.fly^=1;\n                }\n            };\n            \n            const createProgram = (vsh, fsh) => {\n                const vertexShader = gl.createShader(gl.VERTEX_SHADER);\n                gl.shaderSource(vertexShader, vsh);\n                gl.compileShader(vertexShader);\n                const fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);\n                gl.shaderSource(fragmentShader, fsh);\n                gl.compileShader(fragmentShader);\n                \n                const program = gl.createProgram();\n                gl.attachShader(program, vertexShader);\n                gl.attachShader(program, fragmentShader);\n                gl.linkProgram(program);\n                if(!gl.getProgramParameter(program, gl.LINK_STATUS)){\n                    log(gl.getProgramInfoLog(program));\n                    log(gl.getShaderInfoLog(vertexShader));\n                    log(gl.getShaderInfoLog(fragmentShader));\n                }\n                return program;\n            };\n            const program = createProgram(\n                document.getElementById(\"vertex-shader\").text,\n                document.getElementById(\"fragment-shader\").text\n            );\n            gl.useProgram(program);\n            \n            const vao = gl.createVertexArray();\n            gl.bindVertexArray(vao);\n            \n            const buffer = gl.createBuffer();\n            gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n            \n            function cubeData(x,y,z,w,h,d){\n                //x,y,z,color,texCoordx,texCoordy\n                return [x,y,z,,0,0,x,y+h,z,,0,h,x+w,y,z,,w,0,x+w,y,z,,w,0,x,y+h,z,,0,h,x+w,y+h,z,,w,h,x,y,z+d,,0,0,x+w,y,z+d,,0,w,x,y+h,z+d,,h,0,x,y+h,z+d,,h,0,x+w,y,z+d,,0,w,x+w,y+h,z+d,,h,w,x,y,z,,0,0,x,y,z+d,,0,d,x,y+h,z,,h,0,x,y+h,z,,h,0,x,y,z+d,,0,d,x,y+h,z+d,,h,d,x+w,y,z,,0,0,x+w,y+h,z,,0,h,x+w,y,z+d,,d,0,x+w,y,z+d,,d,0,x+w,y+h,z,,0,h,x+w,y+h,z+d,,d,h,x,y,z,,0,0,x+w,y,z,,0,w,x,y,z+d,,d,0,x,y,z+d,,d,0,x+w,y,z,,0,w,x+w,y,z+d,,d,w,x,y+h,z,,0,0,x,y+h,z+d,,0,d,x+w,y+h,z,,w,0,x+w,y+h,z,,w,0,x,y+h,z+d,,0,d,x+w,y+h,z+d,,w,d,];\n            }\n            const sphereData = (() => {\n                const data = [];\n                const res = 10;\n                for(var i = -res; i < res; i++){\n                    for(var k = -res; k < res; k++){\n                        data.push(\n                            i,k,res,0,0,0,\n                            i+1,k,res,0,2,0,\n                            i,k+1,res,0,0,2,\n                            \n                            i+1,k+1,res,0,2,2,\n                            i,k+1,res,0,0,2,\n                            i+1,k,res,0,2,0,\n                            \n                            i,k,-res,0,0,0,\n                            i,k+1,-res,0,0,2,\n                            i+1,k,-res,0,2,0,\n                            \n                            i+1,k+1,-res,0,2,2,\n                            i+1,k,-res,0,2,0,\n                            i,k+1,-res,0,0,2,\n                            \n                            \n                            i,res,k,0,0,0,\n                            i,res,k+1,0,0,2,\n                            i+1,res,k,0,2,0,\n                            \n                            i+1,res,k+1,0,2,2,\n                            i+1,res,k,0,2,0,\n                            i,res,k+1,0,0,2,\n                            \n                            i,-res,k,0,0,0,\n                            i+1,-res,k,0,2,0,\n                            i,-res,k+1,0,0,2,\n                            \n                            i+1,-res,k+1,0,2,2,\n                            i,-res,k+1,0,0,2,\n                            i+1,-res,k,0,2,0,\n                            \n                            \n                            res,i,k,0,0,0,\n                            res,i+1,k,0,2,0,\n                            res,i,k+1,0,0,2,\n                            \n                            res,i+1,k+1,0,2,2,\n                            res,i,k+1,0,0,2,\n                            res,i+1,k,0,2,0,\n                            \n                            -res,i,k,0,0,0,\n                            -res,i,k+1,0,0,2,\n                            -res,i+1,k,0,2,0,\n                            \n                            -res,i+1,k+1,0,2,2,\n                            -res,i+1,k,0,2,0,\n                            -res,i,k+1,0,0,2,\n                        );\n                    }\n                }\n                \n                return function(x,y,z,s){\n                    const ndata = Object.create(data);\n                    for(var i = 0; i < ndata.length; i+=6){\n                        const l = Math.sqrt(ndata[i]**2+ndata[i+1]**2+ndata[i+2]**2)/s;\n                        ndata[i]/=l;\n                        ndata[i+1]/=l;\n                        ndata[i+2]/=l;\n                        ndata[i]+=x;\n                        ndata[i+1]+=y;\n                        ndata[i+2]+=z;\n                    }\n                    return ndata;\n                };\n            })();\n            \n            const data = [];\n            const blockData = [];\n            const checkPointData = [];\n            function addBlock(x,y,z,w,h,d){\n                blockData.push([x,y,z,w,h,d]);\n                data.push(...cubeData(x,y,z,w,h,d));\n            }\n            function addCheckPoint(x,y,z,s){\n                checkPointData.push([x,y,z,s]);\n                data.push(...sphereData(x,y,z,s));\n            }\n            \n            addCheckPoint(-16,30,35,20);\n            addCheckPoint(-11,38,-25,2);\n            addCheckPoint(11,-300,14,2);\n            addCheckPoint(10,57,10,5);\n            const fillSphereEnd = data.length;\n            \n            addBlock(-10,-20,-10,40,20,40);\n            addBlock(-10,40,-10,40,10,40);\n            addBlock(-20,-20,-10,10,70,40);\n            addBlock(20,0,-10,10,40,40);\n            addBlock(-20,-20,-20,40,70,10);\n            \n            // for(var i = 0; i < 10; i++){\n            //     addBlock(\n            //         (Math.random()*4|0)*2,\n            //         i*2,\n            //         (Math.random()*4|0)*2,\n            //         2,\n            //         2,\n            //         2,\n            //     )\n            // }\n            \n            addBlock(-20,10,20,20,20,20);\n            addBlock(-2,2,2,10,2,5);\n            addBlock(-2,0,2,1,2,1);\n            addBlock(7,0,2,1,2,1);\n            addBlock(2,0,8,2,1,2);\n            addBlock(-8,4,2,5,2,5);\n            addBlock(-10,4,2,2,2,2);\n            addBlock(-10,6,-2,2,2,2);\n            addBlock(-10,6,5,4,4,4);\n            addBlock(-2,10,5,4,30,4);\n            addBlock(-4,10,7,2,2,2);\n            addBlock(2,10,7,2,2,2);\n            addBlock(2,14,5,2,0,2);\n            addBlock(4,14,5,0,2,2);\n            addBlock(0,14,3,4,4,2);\n            for(var i = 0; i < 7; i++){\n                addBlock(-10,16+i*2,4+i*2,4,2,2);\n            }\n            \n            addBlock(-22,29,26,2,2,2);\n            addBlock(-22,30,18,2,2,2);\n            addBlock(-22,24,20,2,2,2);\n            addBlock(-22,25,16,2,2,2);\n            addBlock(-22,25,12,2,2,2);\n            addBlock(-22,31,11,2,2,2);\n            addBlock(-22,28,7,2,2,2);\n            addBlock(-22,34,7,2,2,2);\n            addBlock(-22,37,4,2,2,2);\n            addBlock(-22,37,-3,2,2,2);\n            addBlock(-22,33,-12,2,2,2);\n            addBlock(-24,34,-20,4,2,2);\n\n            addBlock(-18,26,-22,2,2,2);\n            addBlock(-18,26,-28,6,2,2);\n            addBlock(-14,26,-32,2,2,4);\n            addBlock(-10,22,-30,2,2,2);\n            addBlock(-10,22,-28,2,6,2);\n            addBlock(-4,22,-28,2,2,2);\n            addBlock(-4,22,-30,2,6,2);\n            addBlock(2,22,-24,2,2,2);\n            addBlock(0,22,-24,2,6,2);\n\n            addBlock(6,24,-22,2,2,2);\n            addBlock(4,24,-22,2,4,2);\n            addBlock(4,29,-26,2,2,2);\n            addBlock(4,32,-30,2,2,2);\n            addBlock(1,35,-32,2,2,2);\n\n            addBlock(-16,28,-30,20,10,10);\n            addBlock(0,39,-22,2,2,2);\n            addBlock(2,40,-22,2,4,2);\n            addBlock(6,44,-22,2,2,2);\n            addBlock(14,48,-22,2,2,2);\n            addBlock(12,40,-22,2,2,2);\n            addBlock(15,43,-22,2,2,2);\n            addBlock(20,44,-22,2,2,6);\n            addBlock(26,44,-12,2,2,2);\n            addBlock(30,45,-8,2,2,2);\n\n            addBlock(30,-20,-8,4,2,4);\n            addBlock(30,-26,0,2,2,2);\n            addBlock(28,-26,0,2,6,2);\n            addBlock(26,-26,-6,2,2,2);\n            addBlock(28,-26,-6,2,6,2);\n            addBlock(18,-26,-4,2,2,2);\n            addBlock(18,-26,-6,2,6,2);\n            addBlock(10,-26,-8,2,2,2);\n            addBlock(10,-26,-6,2,6,2);\n            addBlock(8,-26,-2,2,2,2);\n            addBlock(10,-26,-2,2,6,2);\n            \n            addBlock(8,-24,5,2,4,6);\n            addBlock(12,-24,5,2,4,6);\n            addBlock(10,-24,5,2,2,6);\n            addBlock(6,-24,11,2,4,6);\n            addBlock(14,-24,11,2,4,6);\n            addBlock(8,-24,17,6,4,2)\n            addBlock(8,-294,11,2,270,6);\n            addBlock(12,-294,11,2,270,6);\n            addBlock(10,-294,11,2,270,2);\n            addBlock(10,-294,15,2,270,2);\n\n            addBlock(14,-302,9,2,8,10);\n            addBlock(6,-302,9,2,8,10);\n            addBlock(8,-302,9,6,8,2);\n            addBlock(8,-302,17,6,8,2);\n            \n            //addBlock(14,-306,9,2,10,2);\n            \n            const floatData = new Float32Array(data);\n            const byteData = new Uint8Array(floatData.buffer);\n            for(var i = 12; i < byteData.length; i+=24){\n                if(i>fillSphereEnd*4){\n                    byteData[i] = Math.random()*255;\n                    byteData[i+1] = Math.random()*255;\n                    byteData[i+2] = Math.random()*255;\n                    byteData[i+3] = 255;\n                }else{\n                    byteData[i+4] = 0;\n                }\n            }\n            gl.bufferData(gl.ARRAY_BUFFER,floatData, gl.STATIC_DRAW);\n            \n            const attribs = {};\n            for(const i of [\"a_pos\",\"a_col\",\"a_texCoord\"]){\n                attribs[i] = gl.getAttribLocation(program, i);\n            }\n            \n            gl.enableVertexAttribArray(attribs.a_pos);\n            gl.enableVertexAttribArray(attribs.a_col);\n            gl.enableVertexAttribArray(attribs.a_texCoord);\n            \n            gl.vertexAttribPointer(\n                attribs.a_pos,\n                3,\n                gl.FLOAT,\n                false,\n                24,\n                0);\n            gl.vertexAttribPointer(\n                attribs.a_col,\n                4,\n                gl.UNSIGNED_BYTE,\n                true,\n                24,\n                12);\n            gl.vertexAttribPointer(\n                attribs.a_texCoord,\n                2,\n                gl.FLOAT,\n                false,\n                24,\n                16);\n            \n            const texture = gl.createTexture();\n            gl.bindTexture(gl.TEXTURE_2D,texture);\n            gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, textureCanvas);\n            // const g = new Image();\n            // g.src = \"https://www.kasandbox.org/programming-images/avatars/mr-pink.png\";\n            // g.onload = function(){\n            //     gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, g);\n            //     gl.generateMipmap(gl.TEXTURE_2D);\n            // };\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.REPEAT);\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.REPEAT);\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n            //gl.generateMipmap(gl.TEXTURE_2D);\n            \n            const uniforms = {};\n            for(const i of [\"u_matrix\",\"u_win\"]){\n                uniforms[i] = gl.getUniformLocation(program, i);\n            }\n            gl.clearColor(0,49/255,83/255,1);\n            gl.enable(gl.DEPTH_TEST);\n            //gl.enable(gl.CULL_FACE);\n            //<script>\n            const player = {\n                i:vec3.fromValues(1,0,0),\n                j:vec3.fromValues(0,1,0),\n                k:vec3.fromValues(0,0,1),\n                nj:vec3.fromValues(0,1,0),\n                vi:vec3.fromValues(1,0,0),\n                vj:vec3.fromValues(0,1,0),\n                vk:vec3.fromValues(0,0,1),\n                p:vec3.fromValues(3,1,13),\n                v:vec3.create(),\n                checkPointPos:vec3.fromValues(3,1,13),\n                rad:0.3,\n                jumpTime:0,\n                fly:false,\n                touchGrass:false,\n                won:false,\n                r:{\n                    pitch:0,\n                    roll:0,\n                    yaw:0,\n                },\n                toMatrix(){\n                    const matrix = mat4.create();\n                    mat4.rotate(matrix,matrix,this.r.pitch,this.vi);\n                    mat4.mul(matrix,mat4.transpose(mat4.create(),mat4.fromValues(...this.vi,0,...this.vj,0,...this.vk,0,0,0,0,1)),matrix);\n                    //mat4.rotateX(matrix,matrix,this.r.pitch);\n                    //mat4.rotateY(matrix,matrix,this.r.yaw);\n                    mat4.translate(matrix,matrix,this.p.map(e=>-e));\n                    /*const v = [\n                        Math.abs(this.grav[0]),\n                        Math.abs(this.grav[1]),\n                        Math.abs(this.grav[2])\n                    ];\n                    var c1 = Math.sqrt(v[0]**2+v[1]**2);\n                    var s1 = v[2];\n                    var c2 = c1?v[0]/c1:1;\n                    var s2 = c1?v[1]/c1:0;\n                    mat4.multiply(matrix,matrix,[\n                        v[0],-s2,-s1*c2,0,\n                        v[1],c2,-s1*s2,0,\n                        v[2],0,c1,0,\n                        0,0,0,1\n                    ]);*/\n                    return matrix;\n                },\n                move(){\n                    //const c = Math.cos(this.r.yaw);\n                    //const s = Math.sin(this.r.yaw);\n                    //const cSide = Math.cos(this.r.yaw+Math.PI*0.5);\n                    //const sSide = Math.sin(this.r.yaw+Math.PI*0.5);\n\n                    //mouse.dx*=0.005\n                    const mat = mat4.create();\n                    mat4.rotate(mat,mat,-mouse.dx*0.005,this.j);\n                    vec3.transformMat4(this.i,this.i,mat);\n                    vec3.transformMat4(this.j,this.j,mat);\n                    vec3.transformMat4(this.k,this.k,mat);\n\n                    const speed = 0.01;\n                    if(keys.w){\n                        //this.vx-=cSide*speed;\n                        //this.vz-=sSide*speed;\n                        //this.vx -= this.i[0]*c*speed;\n                        //this.vy -= this.i[1]*c*speed;\n                        //this.vz -= this.i[2]*c*speed;\n                        vec3.scaleAndAdd(this.v,this.v,this.k,-speed);\n                        //vec3.scaleAndAdd(this.v,this.v,this.i,s*speed);\n                    }\n                    if(keys.s){\n                        //this.vx += this.i[0]*c*speed;\n                        //this.vy += this.i[1]*c*speed;\n                        //this.vz += this.i[2]*c*speed;\n                        //this.vx+=cSide*speed;\n                        //this.vz+=sSide*speed;\n                        vec3.scaleAndAdd(this.v,this.v,this.k,speed);\n                    }\n                    if(keys.a){\n                        //this.vx -= this.k[0]*cSide*speed;\n                        //this.vy -= this.k[1]*cSide*speed;\n                        //this.vz -= this.k[2]*cSide*speed;\n                        //this.vx-=c*speed;\n                        //this.vz-=s*speed;\n                        vec3.scaleAndAdd(this.v,this.v,this.i,-speed);\n                    }\n                    if(keys.d){\n                        //this.vx += this.k[0]*cSide*speed;\n                        //this.vy += this.k[1]*cSide*speed;\n                        //this.vz += this.k[2]*cSide*speed;\n                        //this.vx+=c*speed;\n                        //this.vz+=s*speed;\n                        vec3.scaleAndAdd(this.v,this.v,this.i,speed);\n                    }\n                    if(keys.r){\n                        this.p = vec3.clone(this.checkPointPos);\n                        [this.i,this.j,this.k] = [vec3.fromValues(1,0,0),vec3.fromValues(0,1,0),vec3.fromValues(0,0,1)];\n                        this.p[1]+=1;//just a little above.\n                        this.v = vec3.create();\n                        if (vec3.exactEquals(this.checkPointPos,[3,1,13])) start = performance.now();\n                    }\n                    if(!this.fly){\n                        if(keys[\" \"] && this.touchGrass){\n                            //this.vx += this.grav[0]*0.2;\n                            //this.vy += this.grav[1]*0.2;\n                            //this.vz += this.grav[2]*0.2;\n                            vec3.scaleAndAdd(this.v,this.v,this.j,.2);\n                        }\n                    }else{\n                        if(keys[\" \"]){\n                            this.v[1]+=speed;\n                        }\n                        if(keys.shift){\n                            this.v[1]-=speed;\n                        }\n                    }\n                    \n                    //this.r.yaw += mouse.dx*=0.005;\n                    //this.r.yaw%=Math.PI*2;\n                    \n                    this.r.pitch = clamp(this.r.pitch + mouse.dy*0.005, -Math.PI*0.5,Math.PI*0.5);\n                    \n                    //this.v[0]*=.9;\n                    //this.v[1]*=.99;\n                    //this.v[2]*=.9;\n                    const vi = vec3.dot(this.i,this.v);\n                    const vj = vec3.dot(this.j,this.v);\n                    const vk = vec3.dot(this.k,this.v);\n                    this.v = vec3.create();\n                    vec3.scaleAndAdd(this.v,this.v,this.i,.9*vi);\n                    vec3.scaleAndAdd(this.v,this.v,this.j,.99*vj);\n                    vec3.scaleAndAdd(this.v,this.v,this.k,.9*vk);\n                    vec3.add(this.p,this.p,this.v);\n                    if(!this.fly){\n                        //this.v[1]-=0.005;\n                        vec3.scaleAndAdd(this.v,this.v,this.j,-.005);\n                    }else{\n                       this.v[1]*=0.9;\n                    }\n                    this.touchGrass = false;\n                    this.nj = vec3.create();\n                },\n                collideArr(arr){\n                    for(var i = 0; i < arr.length; i++){\n                        const block = arr[i];\n                        //const vx = clamp(this.p[0],block[0],block[0]+block[3]);\n                        //const vy = clamp(this.p[1],block[1],block[1]+block[4]);\n                        //const vz = clamp(this.p[2],block[2],block[2]+block[5]);\n                        const vv = this.p.map((e,i)=>clamp(e,block[0+i],block[0+i]+block[3+i]));\n                        //let dx = this.x-vx,\n                        //dy=this.y-vy,\n                        //dz=this.z-vz;\n                        let dv = vec3.sub(vec3.create(),this.p,vv);\n                        //let d = dx*dx+dy*dy+dz*dz;\n                        let d = vec3.squaredLength(dv);\n                        if(d<this.rad*this.rad+.001){\n                            d=Math.sqrt(d);\n                            if(d){\n                                //dx/=d;dy/=d;dz/=d;\n                                vec3.normalize(dv,dv);\n                                const far = this.rad-d;\n                                //this.x+=dx*far;\n                                //this.y+=dy*far;\n                                //this.z+=dz*far;\n                                vec3.scaleAndAdd(this.p,this.p,dv,far);\n                                \n                                const velAlongNormal =\n                                    //-this.vx * dx+\n                                    //-this.vy * dy+\n                                    //-this.vz * dz;//dot product\n                                    -vec3.dot(this.v,dv);\n                                if(velAlongNormal<0){\n                                    continue;\n                                }\n                                const impulseLength = velAlongNormal*1.01;\n                                //this.vx+=dx*impulseLength;\n                                //this.vy+=dy*impulseLength;\n                                //this.vz+=dz*impulseLength;\n                                vec3.scaleAndAdd(this.v,this.v,dv,impulseLength);\n                                //if(this.touchGrass){\n                                //    this.grav[0]+=dx;this.grav[1]+=dy;this.grav[2]+=dz;\n                                //}else{\n                                //    this.grav[0]=dx;this.grav[1]=dy;this.grav[2]=dz;\n                                //}\n                                vec3.add(this.nj,this.nj,dv);\n                            }else{\n                                this.p[1] = block[1] + block[4] + this.rad*2;\n                                this.v[1] = 0;\n                            }\n                            this.touchGrass = true;\n                        }\n                    }\n                },\n                handleCheckPoints(arr){\n                    for(var i = 0; i < arr.length; i++){\n                        let checkPoint = arr[i];\n                        //let dx = this.x-checkPoint[0];\n                        //let dy = this.y-checkPoint[1];\n                        //let dz = this.z-checkPoint[2];\n                        let dv = vec3.sub(vec3.create(),this.p,vec3.fromValues(checkPoint[0],checkPoint[1],checkPoint[2]));\n                        //let d = dx*dx+dy*dy+dz*dz;\n                        let d = vec3.squaredLength(dv);\n                        if(d<((checkPoint[3])+this.rad)**2+.001){\n                            if (i==arr.length-1) {gl.uniform1i(uniforms.u_win,1);this.won=true};\n                            d=Math.sqrt(d);\n                            //dx/=d;dy/=d;dz/=d;\n                            vec3.normalize(dv,dv);\n                            const far = this.rad+(checkPoint[3])-d;\n                            //this.x+=dx*far;\n                            //this.y+=dy*far;\n                            //this.z+=dz*far;\n                            vec3.scaleAndAdd(this.p,this.p,dv,far);\n                            this.jumpTime = 10;\n                            \n                            const velAlongNormal =\n                                //-this.vx * dx+\n                                //-this.vy * dy+\n                                //-this.vz * dz;//dot product\n                                -vec3.dot(this.v,dv);\n                            if(velAlongNormal<0){\n                                continue;\n                            }\n                            const impulseLength = velAlongNormal*1.01;\n                            //this.vx+=dx*impulseLength;\n                            //this.vy+=dy*impulseLength;\n                            //this.vz+=dz*impulseLength;\n                            vec3.scaleAndAdd(this.v,this.v,dv,impulseLength);\n                            //if(this.touchGrass){\n                            //    this.grav[0]+=dx;this.grav[1]+=dy;this.grav[2]+=dz;\n                            //}else{\n                            //    this.grav[0]=dx;this.grav[1]=dy;this.grav[2]=dz;\n                            //}\n                            vec3.add(this.nj,this.nj,dv);\n                            this.touchGrass = true;\n                        }\n                    }\n                },\n                rotateIJK(){\n                    if (vec3.squaredLength(this.nj) == 0 || vec3.equals(this.j,vec3.normalize(this.nj,this.nj))) return;\n                    const about = vec3.cross(vec3.create(),this.j,this.nj);\n                    let ang = vec3.angle(this.j,this.nj);\n                    if (vec3.dot(this.nj,this.j) < -.99 && this.touchGrass) ang=Math.PI,vec3.set(about,...this.k);\n                    const mat = mat4.create();\n                    mat4.rotate(mat,mat,ang,about);\n                    vec3.transformMat4(this.i,this.i,mat);\n                    vec3.transformMat4(this.j,this.j,mat);\n                    vec3.transformMat4(this.k,this.k,mat);\n                },\n                rotateV(){\n                    let ang = vec3.angle(this.j,this.vj);\n                    const v = vec3.clone(this.vj);\n                    this.vi = vec3.clone(this.i);\n                    this.vj = vec3.clone(this.j);\n                    this.vk = vec3.clone(this.k);\n                    if (Math.abs(ang) < .001) return;\n                    const about = vec3.cross(vec3.create(),this.j,v);\n                    if (vec3.dot(v,this.j) < -.999) ang=Math.PI,vec3.set(about,...this.k);\n                    const mat = mat4.create();\n                    mat4.rotate(mat,mat,Math.abs(ang) < .1 ? 0 : ang-Math.sign(ang)*.1,about);\n                    vec3.transformMat4(this.vi,this.vi,mat);\n                    vec3.transformMat4(this.vj,this.vj,mat);\n                    vec3.transformMat4(this.vk,this.vk,mat);\n                }\n            };\n            cancelAnimationFrame(window.parent.raf);\n            const pos = document.getElementById(\"pos\");\n            const timer = document.getElementById(\"timer\");\n            let start = performance.now();\n            const render = () => {\n                try{\n                player.move();\n                player.collideArr(blockData);\n                player.handleCheckPoints(checkPointData);\n                player.rotateIJK();\n                player.rotateV();\n                \n                pos.innerText = player.p.map(e=>e.toFixed(2)).join(\",\");\n                if (!player.won) timer.innerText = ((performance.now()-start)/1000).toFixed(2);\n                \n                const matrix = mat4.create();\n                mat4.perspective(matrix,Math.PI/2,1,0.01,100000);\n                mat4.multiply(matrix,matrix,player.toMatrix());\n                gl.uniformMatrix4fv(uniforms.u_matrix,false,matrix);\n                \n                gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n                gl.uniform1i(uniforms.u_win,0);\n                gl.drawArrays(gl.TRIANGLES,0,data.length/6);\n                gl.uniform1i(uniforms.u_win,1);\n                gl.drawArrays(gl.LINES,0,data.length/6);\n                window.parent.raf = requestAnimationFrame(render);\n                }catch(err){\n                    log(err);\n                }\n                mouse.resetDelta();\n            };\n            render();\n            log(gl.getError());\n        }catch(err){\n            log(err);\n        }\n        </script>\n    </body>\n</html>","title":"gravy juice world","votes":38,"type":"HTML","author":{"name":"YokieBob","id":"kaid_681887786554114354822051","avatar":"/images/avatars/svg/marcimus-red.svg"},"dimensions":{"width":600,"height":600},"forks":[{"title":"Spin-off of \"gravy juice world\"","id":"4531490372632576","forks":0,"votes":5,"author":{"name":"Bearkirb314🐻‍❄️","id":"kaid_375460112550893828689953"}},{"title":"Spin-off of \"gravy juice world\"","id":"4812528235757568","forks":0,"votes":1,"author":{"name":"bigbossbowser809","id":"kaid_1610327077928597376372358"}},{"title":"Spin-off of \"gravy juice world\"","id":"5694289719246848","forks":0,"votes":1,"author":{"name":"Froggers","id":"kaid_626525123143446988466481"}},{"title":"Spin-off of \"gravy juice world\"","id":"5792197827280896","forks":0,"votes":1,"author":{"name":"BasilSmith","id":"kaid_714484399525149147489548"}},{"title":"gravy doesn't exist","id":"6127404421922816","forks":0,"votes":1,"author":{"name":"ImNotThiaggo","id":"kaid_787625359016180110453653"}},{"title":"Spin-off of \"gravy juice world\"","id":"6340028287860736","forks":0,"votes":1,"author":{"name":"LoganN","id":"kaid_575710167256746832709232"}},{"title":"Spin-off of \"gravy juice world\"","id":"6350117400920064","forks":0,"votes":1,"author":{"name":"Michael Horton","id":"kaid_617431371975855126289855"}}],"posts":{"tips":[{"replyCount":0,"votes":4,"date":"2024-10-25T01:17:04.470478Z","author":{"name":"Cyan Spirit","id":"kaid_1418532449612597727143882","avatar":"/images/avatars/svg/cacteye-blue.svg"},"text":"I was like:\nOh, I've played this so many times already\nAnd then like:\nWhat? I'm on the wall?\n\nThis is actually really cool how the gravity changes to the surface you touch!","locked":false,"pinned":false,"replies":[]},{"replyCount":7,"votes":3,"date":"2024-10-25T00:34:31.546757Z","author":{"name":"Jake K.","id":"kaid_103000698141866290580261","avatar":"/images/avatars/svg/leaf-blue.svg"},"text":"I LOVE it! I feel like an astronaut.\n\nAlso you should add the bloom that we made.","locked":false,"pinned":false,"replies":[{"date":"2024-10-25T13:17:27.414773Z","author":{"name":"YokieBob","id":"kaid_681887786554114354822051","avatar":"/images/avatars/svg/marcimus-red.svg"},"text":"Thanks!\nLove the bloom in all its staticky glory, but it's too slow to be the main program 😎#OnAChromeBookEternallyHelp"},{"date":"2024-10-25T14:09:34.410799Z","author":{"name":"Jake K.","id":"kaid_103000698141866290580261","avatar":"/images/avatars/svg/leaf-blue.svg"},"text":"Yay!  I'll tell Bearkirb it's too slow and he will probably have a conniption but maybe he will make it better. \n\nMy condolences... D:\nWe are here to support you..."},{"date":"2024-10-25T14:13:47.880088Z","author":{"name":"YokieBob","id":"kaid_681887786554114354822051","avatar":"/images/avatars/svg/marcimus-red.svg"},"text":"I made it faster by changing the loop 150 times to like 20, but it's a little less glowy."},{"date":"2024-10-25T14:26:32.943366Z","author":{"name":"Jake K.","id":"kaid_103000698141866290580261","avatar":"/images/avatars/svg/leaf-blue.svg"},"text":"Yeah that sounds like bearkirb, things need to be as glowy as possible.  \n\ntouchGrass variable is epic"},{"date":"2024-10-25T15:42:19.447204Z","author":{"name":"kitty mascot","id":"kaid_1066778980955332043559618","avatar":"/images/avatars/svg/sneak-peak-green.svg"},"text":"get a REAL computer and that should fix the problem."},{"date":"2024-10-25T16:04:21.995412Z","author":{"name":"YokieBob","id":"kaid_681887786554114354822051","avatar":"/images/avatars/svg/marcimus-red.svg"},"text":"@jake\nHaha yeah, was canJump but then it changed.\n\n@kitty mascot\nBro what you mean you think I got that money lucky to get Chromebook from school in first place maybe just program faster programs instead of spending actual money. /j"},{"date":"2024-10-25T16:06:49.902296Z","author":{"name":"kitty mascot","id":"kaid_1066778980955332043559618","avatar":"/images/avatars/svg/sneak-peak-green.svg"},"text":"sorry :("}]},{"replyCount":2,"votes":3,"date":"2024-10-24T23:26:02.139556Z","author":{"name":"Bearkirb314🐻‍❄️","id":"kaid_375460112550893828689953","avatar":"/images/avatars/svg/cs-hopper-cool.svg"},"text":"Ohmygod it does the thing.\n\n\n\nglowy edges could use some bloom tho","locked":false,"pinned":false,"replies":[{"date":"2024-10-25T00:01:13.841637Z","author":{"name":"Bearkirb314🐻‍❄️","id":"kaid_375460112550893828689953","avatar":"/images/avatars/svg/cs-hopper-cool.svg"},"text":"Ok added bloom cause I wanted to.\n\nhttps://www.khanacademy.org/computer-programming/spin-off-of-gravy-juice-world/4531490372632576"},{"date":"2024-10-25T13:10:47.468753Z","author":{"name":"YokieBob","id":"kaid_681887786554114354822051","avatar":"/images/avatars/svg/marcimus-red.svg"},"text":"Wow that's so cool. I love the bulge effect in the middle."}]},{"replyCount":1,"votes":2,"date":"2024-10-25T00:06:08.61337Z","author":{"name":"Danomi42","id":"kaid_1045282636896433254069987","avatar":"/images/avatars/svg/primosaur-sapling.svg"},"text":"OMG I'm loving this! I wish I could vote up more, but unfortunately I only get to do it once. 😭 THIS IS AMAZING!\n\n(I'd love to see this in a full-scale 3D (platformer?) game.)","locked":false,"pinned":false,"replies":[{"date":"2024-10-25T13:17:47.718781Z","author":{"name":"YokieBob","id":"kaid_681887786554114354822051","avatar":"/images/avatars/svg/marcimus-red.svg"},"text":"Thanks! Don't expect a full game, bad at finishing those things."}]},{"replyCount":0,"votes":2,"date":"2024-10-25T16:18:10.445911Z","author":{"name":"Electric Dolphin ⚡️🐬","id":"kaid_1188776231699286995947997","avatar":"/images/avatars/svg/cs-hopper-cool.svg"},"text":"Run.\nGood job with this!","locked":false,"pinned":false,"replies":[]},{"replyCount":0,"votes":2,"date":"2024-10-25T16:44:11.449688Z","author":{"name":"HB_the_Pencil (semi-retired)","id":"kaid_412656070256786668848958","avatar":"/images/avatars/svg/mr-pants-green.svg"},"text":"Dang, that's crazy trippy. Really awesome!!","locked":false,"pinned":false,"replies":[]},{"replyCount":0,"votes":1,"date":"2024-10-25T14:48:00.317773Z","author":{"name":"-|Sir Bob|-","id":"kaid_1620278273238556858984425","avatar":"/images/avatars/svg/cs-hopper-cool.svg"},"text":"Coolest thing I've seen all day! Vote ++","locked":false,"pinned":false,"replies":[]},{"replyCount":2,"votes":1,"date":"2024-10-24T23:24:00.294674Z","author":{"name":"Duke :P","id":"kaid_351465532815782433620675","avatar":"/images/avatars/svg/starky-ultimate.svg"},"text":"wow this is super cool :O","locked":false,"pinned":false,"replies":[{"date":"2024-10-24T23:26:39.637205Z","author":{"name":"The Former Wizard of Oz","id":"kaid_981854986090143486946241","avatar":"/images/avatars/svg/leaf-blue.svg"},"text":"```{\n    wowThisIsSuperCool : O\n}```"},{"date":"2024-10-24T23:40:52.513233Z","author":{"name":"Duke :P","id":"kaid_351465532815782433620675","avatar":"/images/avatars/svg/starky-ultimate.svg"},"text":"yeah that lol"}]},{"replyCount":0,"votes":1,"date":"2024-10-25T17:14:25.991019Z","author":{"name":"That One Guy ME","id":"kaid_3823720261811268848400557","avatar":"/images/avatars/svg/duskpin-seed.svg"},"text":"woah cool","locked":false,"pinned":false,"replies":[]},{"replyCount":1,"votes":1,"date":"2024-10-25T16:31:27.049618Z","author":{"name":"Dat","id":"kaid_4164356982737975081215128","avatar":"/images/avatars/svg/marcimus-orange.svg"},"text":"reminds me of p3d","locked":false,"pinned":false,"replies":[{"date":"2024-10-25T16:59:46.620406Z","author":{"name":"Equilibrium","id":"kaid_1842852586096096865081151","avatar":"/images/avatars/svg/sneak-peak-green.svg"},"text":"Ahh yes, p3d, the GOAT."}]},{"replyCount":2,"votes":1,"date":"2024-10-25T13:10:18.439677Z","author":{"name":"Hokeycat","id":"kaid_438466413527508491816275","avatar":"/images/avatars/svg/blobby-green.svg"},"text":"If you press 'm' you can fly!","locked":false,"pinned":false,"replies":[{"date":"2024-10-25T13:16:01.695127Z","author":{"name":"YokieBob","id":"kaid_681887786554114354822051","avatar":"/images/avatars/svg/marcimus-red.svg"},"text":"Yup! But it breaks if you have already changed gravity and you can change gravity so why bother."},{"date":"2024-10-25T13:21:59.852858Z","author":{"name":"Hokeycat","id":"kaid_438466413527508491816275","avatar":"/images/avatars/svg/blobby-green.svg"},"text":"Yeah, I just noticed that..."}]},{"replyCount":0,"votes":1,"date":"2024-10-25T07:27:11.408281Z","author":{"name":"OP_Hero","id":"kaid_6184382440467937196472446","avatar":"/images/avatars/svg/piceratops-tree.svg"},"text":"me:\nclimbing the tower like 10 times\nalso me:\nfinaly, huh? what is this hole *jumps down* Broooooooooooooooooo","locked":false,"pinned":false,"replies":[]},{"replyCount":0,"votes":1,"date":"2024-10-25T00:07:54.94689Z","author":{"name":"ASBackup","id":"kaid_714780036830891967670231","avatar":"/images/avatars/svg/aqualine-tree.svg"},"text":"ey the full screen release :)\nlike the added outlines :D\ngood job :)","locked":false,"pinned":false,"replies":[]},{"replyCount":0,"votes":1,"date":"2024-10-25T11:59:48.392852Z","author":{"name":"cwalsh1223 BBB#","id":"kaid_792288208072906614241148","avatar":"/images/avatars/svg/spunky-sam-red.svg"},"text":"Nice!           \n                                        votes +=1;\n\nthis is tRipPY>!>!>!  ah","locked":false,"pinned":false,"replies":[]},{"replyCount":0,"votes":1,"date":"2024-10-25T01:20:05.366024Z","author":{"name":"Luke Ellis","id":"kaid_8535468719137003545030723","avatar":"/images/avatars/svg/orange-juice-squid.svg"},"text":"I give you a total of 10 votes. This is crazy cool.","locked":false,"pinned":false,"replies":[]}],"questions":[]}}